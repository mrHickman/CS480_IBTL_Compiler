'''
Created on Feb 5, 2014

@author: mr_hickman
'''

from token import Token # ?
import sys
import time 
from lexicalAnalyzer import LexicalAnalyzer
from parseTree import ParseTree 

# addNode() gets next token and adds Node to tree

class Parser :
    def T(self):
        if self.currentToken == '[' :
            self.S()
            if self.currentToken == ']' :
                return
            else :
                error
        else :
            error
        
    def S(self):
        if self.currentToken == '[' :
            self.getNextToken()
            if self.currentToken == ']' :
                self.getNextToken()
                self.Sp()
            elif self.currentToken == '[' :
                self.getNextToken()
                self.S()
                if self.currentToken == ']' :
                    self.getNextToken()
                    self.Sp()
                else :
                    error
            elif self.currentToken.type == statement :
                self.statement()
                self.Sp()
            elif self.currentToken.type == oper :
                self.oper()
                self.Sp()
            else :
                error
        elif self.currentToken.type == string or int or float or name :
            self.oper()    
            self.Sp()
        else :
            error
            
    def Sp(self):
        if self.currentToken == '[' or self.currentToken.type == string or int or float or name :
            self.S()
            self.Sp()
        # the else statement of this is epsilon
        
    def expr(self):
        if self.currentToken == '[' :
            self.getNextToken()
            if self.currentToken.type == statement :
                self.statement()
            elif self.currentToken.type == oper :
                self.oper()
            else :
                error
        elif self.currentToken.type == string or int or float or name :
            self.oper()
        else :
            error
            
    def statement(self):
        if self.currentToken.value == 'if' :
            self.getNextToken()
            self.expr()
            self.expr()
            if self.currentToken == ']' :
                self.getNextToken()
            else :
                self.expr()
                if self.currentToken == ']' :
                    self.getNextToken()
                else :
                    error
        elif self.currentToken.value == 'while' :
            self.getNextToken()
            self.expr()
            self.exprlist()
            if self.currentToken == ']' :
                self.getNextToken()
            else :
                error
        elif self.currentToken.value == 'let' :
            self.getNextToken()
            if self.currentToken == '[' :
                self.getNextToken()
                self.varlist()
                if self.currentToken == ']' :
                    self.getNextToken()
                else :
                    error
            else :
                error
        elif self.currentToken.value == 'stdout' :
            self.getNextToken()
            self.oper()
            if self.currentToken == ']' :
                self.getNextToken()
            else :
                error
        else:
            error
            
    def oper(self):
        if self.currentToken.type == string or int or float or name :
            self.termOper()
        else :
            self.nonTermOper()
    
    def termOper(self):
        self.addTermNode()
        
    def nonTermOper(self):
        if self.currentToken.type == binop :
            self.binop()
        elif self.currentToken.type == unop :
            self.unop()
        elif self.currentToken.type == op :
            self.op()
        elif self.currentToken.type == assign :
            self.assign()
        else :
            error
            
    def binop(self):
        self.addNonTermNode()
        self.oper()
        self.oper()
        if self.currentToken.value == ']' :
            self.getNextToken()
        else :
            error
            
    def unop(self):
        self.addNonTermNode()
        self.oper()
        if self.currentToken.value == ']' :
            self.getNextToken()
        else :
            error
            
    def op(self):
        self.addNonTermNode()
        self.oper()
        if self.currentToken.value == ']' :
            self.getNextToken()
        else :
            self.oper()
            if self.currentToken.value == ']' :
                self.getNextToken()
            else :
                error
            
    def assign(self):
        self.addNonTermNode()
        if self.currentToken.type == name :
            self.addTermNode()
            self.oper()
            if self.currentToken.type == ']' :
                self.getNextToken()
            else :
                error
        else :
            error
        
    def exprlist(self):
        self.expr()
        if self.currentToken.value != ']' :
            self.exprlist()
    
    def varlist(self):
        if self.currentToken.type == name :
            self.addTermNode()
            if self.currentToken.type == 'type' :
                self.addTermNode()
                if self.currentToken.value == ']' :
                    self.getNextToken()
                else :
                    error
            else :
                error
        else :
            error
        if self.currentToken.value != ']' :
            self.varlist()
        
    def addNonTermNode(self):
        
    def addTermNode(self):
        
    def getNextToken(self):
        
    def error(self):